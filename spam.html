import telebot
import datetime
import time
import os,sys,re
import subprocess
import requests
from telegram import Update
from telegram.ext import Updater, CommandHandler, CallbackContext
import requests
from bs4 import BeautifulSoup
os.system("cls" if os.name == "nt" else "clear")
banner="""
\033[1;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
\033[1;32mâ•‘ â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—       â•‘
\033[1;35mâ•‘ â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•  â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘       â•‘
\033[1;31mâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘       â•‘
\033[1;33mâ•‘ â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â•šâ•â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘       â•‘
\033[1;34mâ•‘ â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â•‘
\033[1;37mâ•‘ â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•    â•šâ•â•        â•šâ•â•    â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•  â•‘
\033[1;34mâ• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
\033[1;32mâ•‘â¢ Author   : HDT - TOOL                                          â•‘
\033[1;36mâ•‘â¢ Youtube  : https://youtube.com/@HDT-TOOL                       â•‘
\033[1;31mâ•‘â£ NhÃ³m Zalo  : https://zalo.me/g/bprmyn080                       â•‘
\033[1;33mâ•‘â£ Website  : https://hdt-tool.blogspot.com                       â•‘
\033[1;32mâ•‘â£ NhÃ³m Telegram : https://t.me/hdttool                           â•‘
\033[1;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
\033[1;32m â£ â£ â£ â£ â£ â£ \033[1;33mÄang Cháº¡y Bot Telegram \033[1;32mâ£ â£ â£ â£ â£ â£
"""
for X in banner:
  sys.stdout.write(X)
  sys.stdout.flush() 
bot_token = '6573889702:AAGaHzdWTP7tqUou7-3qkUA3j6gDRrFvrnE' 
bot = telebot.TeleBot(bot_token)
processes = []
ADMIN_ID = '5668021745'
allowed_group_id = -1001672505750
def TimeStamp():
    now = str(datetime.date.today())
    return now

@bot.message_handler(commands=['getkey'])
def startkey(message):
    bot.reply_to(message, text='VUI LÃ’NG Äá»¢I TRONG GIÃ‚Y LÃT!')
    key = "HDT-" + str(int(message.from_user.id) * int(datetime.date.today().day) - 12666)
    key = "https://html-css-js.hdt-tool.repl.co/?key=" + key
    print(key)
    api_token = '64dede03981c99475d22f97f'
    url = requests.get(f'https://link4m.co/api-shorten/v2?api={api_token}&url={key}').json()
    url_key = url['shortenedUrl']
    text = f'''- https://hdttool2023.000webhostapp.com/+.mp4
- LINK Láº¤Y KEY {TimeStamp()} LÃ€: {url_key}
- KHI Láº¤Y KEY XONG, DÃ™NG Lá»†NH /key <key> Äá»‚ TIáº¾P Tá»¤C
'''
    bot.reply_to(message, text)


@bot.message_handler(commands=['key'])
def key(message):
    if len(message.text.split()) == 1:
        bot.reply_to(message, 'VUI LÃ’NG NHáº¬P KEY.')
        return

    user_id = message.from_user.id

    key = message.text.split()[1]
    username = message.from_user.username
    expected_key = "HDT-" + str(int(message.from_user.id) * int(datetime.date.today().day) - 12666)
    if key == expected_key:
        bot.reply_to(message, f' [ KEY Há»¢P Lá»† ] NGÆ¯á»œI DÃ™NG CÃ“ ID: [ {user_id} ] ÄÆ¯á»¢C PHÃ‰P ÄÆ¯á»¢C Sá»¬ Dá»¤NG Lá»†NH    [ /spam ]')
        fi = open(f'./user/{datetime.date.today().day}/{user_id}.txt',"w")
        fi.write("")
        fi.close()
    else:
        bot.reply_to(message, 'KEY KHÃ”NG Há»¢P Lá»†.')
  
@bot.message_handler(commands=['spam'])
def spam(message):
    user_id = message.from_user.id
    if not os.path.exists(f"./user/{datetime.date.today().day}/{user_id}.txt"):
      bot.reply_to(message, 'DÃ¹ng /getkey Äá»ƒ Láº¥y Key VÃ  DÃ¹ng /key Äá»ƒ Nháº­p Key HÃ´m Nay!')
      return
    if len(message.text.split()) == 1:
        bot.reply_to(message, 'VUI LÃ’NG NHáº¬P Sá» ÄIá»†N THOáº I ')
        return
    if len(message.text.split()) == 2:
        bot.reply_to(message, 'Vui LÃ²ng Nháº­p ÄÃºng Äá»‹nh Dáº¡ng | VÃ­ Dá»¥: /spam 0987654321 50')
        return
    lap = message.text.split()[2]
    if lap.isnumeric():
      if not (int(lap) > 0 and int(lap) <= 50):
        bot.reply_to(message,"Vui LÃ²ng Spam Trong Khoáº£ng 1 - 50 ThÃ´i !!")
        return
    else:
      bot.reply_to(message,"Sai Sá»‘ Láº§n Spam !!!")
      return
    phone_number = message.text.split()[1]
    if not re.search("^(0?)(3[2-9]|5[6|8|9]|7[0|6-9]|8[0-6|8|9]|9[0-4|6-9])[0-9]{7}$",phone_number):
        bot.reply_to(message, 'Sá» ÄIá»†N THOáº I KHÃ”NG Há»¢P Lá»† !')
        return

    if phone_number in ["0365956335"]:
        # Sá»‘ Ä‘iá»‡n thoáº¡i náº±m trong danh sÃ¡ch cáº¥m
        bot.reply_to(message,"Spam cÃ¡i Ä‘áº§u buá»“i tao huhu")
        return
    file_path = os.path.join(os.getcwd(), "sms.py")
    process = subprocess.Popen(["python", file_path, phone_number, lap])
    processes.append(process)
    bot.reply_to(message, f'â¤ ID Cá»§a Báº¡n LÃ : [ {user_id} ]\nâ¤ Táº¥n CÃ´ng SÄT: [ {phone_number} ]ThÃ nh CÃ´ng âœ…\nâ¤ Láº·p Láº¡i : {lap} â°\nâ¤ NgÃ y : {TimeStamp()}\nâ¤ Chá»§ Bot : ğ‡ğƒğ“-ğ“ğğğ‹\n https://hdttool2023.000webhostapp.com/_.mp4\n')
@bot.message_handler(commands=['help'])
def help(message):
    help_text = '''
Danh sÃ¡ch lá»‡nh:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”£â¤/getkey: Äá»ƒ Láº¥y Key âœ…
â”£â¤/key: Äá»ƒ Nháº­p Key âœ…
â”£â¤/spam {SÄT} {Sá»‘ Láº§n} âœ…
â”£â¤/check + [host] : Kiá»ƒm Tra AntiDDoS âœ…
â”£â¤/help: Danh sÃ¡ch lá»‡nh âœ…
â”£â¤/time Thá»i Gian HÄ Bot âœ…
â”£â¤/status LÆ°á»£t Cháº¡y Bot âœ…
â”£â¤/admin ThÃ´ng Tin Admin âœ…
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
'''
    bot.reply_to(message, help_text)
    
# status
@bot.message_handler(commands=['status'])
def status(message):
    user_id = message.from_user.id
    if str(user_id) != ADMIN_ID:
        bot.reply_to(message, 'Báº¡n khÃ´ng cÃ³ quyá»n sá»­ dá»¥ng lá»‡nh nÃ y.')
        return
    process_count = len(processes)
    bot.reply_to(message, f'Sá»‘ quy trÃ¬nh Ä‘ang cháº¡y: {process_count}.')
#cpu
# khoir dong lai bot
@bot.message_handler(commands=['time'])
def show_uptime(message):
    current_time = time.time()
    uptime = current_time
    hours = int(uptime // 3600)
    minutes = int((uptime % 3600) // 60)
    seconds = int(uptime % 60)
    bot.reply_to(message, f'Bot ÄÃ£ Hoáº¡t Äá»™ng ÄÆ°á»£c: {hours} giá», {minutes} phÃºt, {seconds} giÃ¢y')
#check
@bot.message_handler(commands=['check'])
def check_ip(message):
    if len(message.text.split()) != 2:
        bot.reply_to(message, 'Vui lÃ²ng nháº­p Ä‘Ãºng cÃº phÃ¡p.\nVÃ­ dá»¥: /check + [link website]')
        return

    url = message.text.split()[1]
    
    # Kiá»ƒm tra xem URL cÃ³ http/https chÆ°a, náº¿u chÆ°a thÃªm vÃ o
    if not url.startswith(("http://", "https://")):
        url = "http://" + url

    # Loáº¡i bá» tiá»n tá»‘ "www" náº¿u cÃ³
    url = re.sub(r'^(http://|https://)?(www\d?\.)?', '', url)
    
    try:
        ip_list = socket.gethostbyname_ex(url)[2]
        ip_count = len(ip_list)

        reply = f"Ip cá»§a website: {url}\nLÃ : {', '.join(ip_list)}\n"
        if ip_count == 1:
            reply += "Website cÃ³ 1 ip cÃ³ kháº£ nÄƒng khÃ´ng antiddos."
        else:
            reply += "Website cÃ³ nhiá»u hÆ¡n 1 ip kháº£ nÄƒng antiddos ráº¥t cao.\nKhÃ´ng thá»ƒ táº¥n cÃ´ng website nÃ y."

        bot.reply_to(message, reply)
    except Exception as e:
        bot.reply_to(message, f"CÃ³ lá»—i xáº£y ra: {str(e)}")
#admin
@bot.message_handler(commands=['admin'])
def admin_info(message):
    # Thay tháº¿ cÃ¡c giÃ¡ trá»‹ sau báº±ng thÃ´ng tin liÃªn há»‡ cá»§a báº¡n
    telegram_url = "https://t.me/llll0l0llll"
    zalo_box = "https://zalo.me/g/bprmyn080"
    youtube_url = "https://youtube.com/@HDT-TOOL"
    web_url = "https://hdt-tool.blogspot.com"
    admin_message = f"ThÃ´ng tin liÃªn há»‡ cá»§a Admin:\n\ntelegram: {telegram_url}\nBox Zalo: {zalo_box}\nweb: {web_url}\nyoutube: {youtube_url}"
    bot.reply_to(message, admin_message)
# lo 
@bot.message_handler(func=lambda message: True)
def echo_all(message):
    bot.reply_to(message, 'Lá»‡nh khÃ´ng há»£p lá»‡. Vui lÃ²ng sá»­ dá»¥ng lá»‡nh /help Ä‘á»ƒ xem danh sÃ¡ch lá»‡nh.')

bot.infinity_polling(timeout=60, long_polling_timeout = 1)
