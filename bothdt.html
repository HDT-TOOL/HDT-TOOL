import requests
import random
from datetime import datetime, timedelta
from threading import Thread, Timer
import os
import telebot
import re
import sqlite3
import webbrowser
from telebot import types
import time
import base64
import subprocess

bot_start_time = datetime.now()
current_time = datetime.now().strftime('%d/%m/%Y %H:%M:%S')
def poll_bot():
    while True:
        try:
            bot.polling(timeout=500000)
        except Exception as e:
            print(f"CÃ³ lá»—i xáº£y ra: {e}")
            print("Thá»­ láº¡i sau 5 giÃ¢y...")
            time.sleep(5)

os.system('clear')
logo=f"""
\033[1;34mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
\033[1;32mâ•‘ â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—       â•‘
\033[1;35mâ•‘ â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•  â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘       â•‘
\033[1;31mâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘       â•‘
\033[1;33mâ•‘ â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â•šâ•â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘       â•‘
\033[1;34mâ•‘ â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â•‘
\033[1;37mâ•‘ â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•    â•šâ•â•        â•šâ•â•    â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•  â•‘
\033[1;34mâ• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
\033[1;32mâ•‘â¢ Author   : HDT - TOOL                                          â•‘
\033[1;36mâ•‘â¢ Youtube  : https://youtube.com/@HDT-TOOL                       â•‘
\033[1;31mâ•‘â£ NhÃ³m Zalo  : https://zalo.me/g/bprmyn080                       â•‘
\033[1;33mâ•‘â£ Website  : https://hdt-tool.blogspot.com                       â•‘
\033[1;32mâ•‘â£ NhÃ³m Telegram : https://t.me/hdttool                           â•‘
\033[1;34mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
\033[1;32m â£ â£ â£ â£ â£ â£ \033[1;33mÄang Cháº¡y Bot ğŸ HDT - TOOLğŸ \033[1;32mâ£ â£ â£ â£ â£ â£"""
  
print(logo)
bot_token = '6462841541:AAFZbRq7Dtpye2CLRDwjvvgzhn8bb4Fx5Rw' #thay token bot nha ae token láº¥y á»Ÿ botfather 

header = {"Accept": "application/json", "Content-Type": "application/json"}

bot = telebot.TeleBot(bot_token)
session = requests.Session()

allowed_users = []
processes = []
ADMIN_ID = 5668021745 

allowed_users.extend([ADMIN_ID])

import requests
import random
from datetime import datetime
video_links = [
    "https://hdttool2023.000webhostapp.com/_.mp4",
    "https://hdttool2023.000webhostapp.com/+.mp4",
    "https://baohayhomnay24h.000webhostapp.com/video/3.mp4",
    "https://baohayhomnay24h.000webhostapp.com/video/4.mp4",
    "https://baohayhomnay24h.000webhostapp.com/video/5.mp4",
    "https://baohayhomnay24h.000webhostapp.com/video/6.mp4",
    "https://baohayhomnay24h.000webhostapp.com/video/7.mp4",
    "https://baohayhomnay24h.000webhostapp.com/video/8.mp4",
]

user_key_count = {}
@bot.message_handler(commands=['get_key'])
def get_key(message):
    ngay = int(datetime.now().strftime('%d'))
    key1=str(ngay*199872767+168299)
    key = 'HDT-' + key1
    url = 'https://html-css-js.hdt-tool.repl.co/?key=' + key
    like4m = requests.get(f'https://web1s.com/api?token=0cb3f67e-905e-4beb-b97e-075d25147645&url={url}').json()
    web1s = requests.get(f'https://web1s.com/api?token=0cb3f67e-905e-4beb-b97e-075d25147645&url={url}').json()
    if like4m['status'] == "error":
        bot.reply_to(message, like4m['message'])
    else:
        link_key1 = like4m['shortenedUrl']
        
    if web1s['status'] == "error":
        bot.reply_to(message, web1s['message'])
    else:
        link_key2 = web1s['shortenedUrl']
        random_video_url = random.choice(video_links)
        current_time = datetime.now().strftime('%d/%m/%Y %H:%M:%S')
        user_id = message.from_user.id
        if user_id not in user_key_count:
            user_key_count[user_id] = 1
        else:
            user_key_count[user_id] += 1
        
        key_count = user_key_count[user_id]
        message_text = f'ğŸŒºAdmin Tool: HDT-TOOL ğŸŒº\nLÆ°u Ã½ ğŸš¨: ÄÃ¢y lÃ  key Tool khÃ´ng pháº£i key bot\nBot ğŸ”‘: https://t.me/keyhdttool\nChá»§ sá»Ÿ há»¯u ğŸ‘‘: @llll0l0llll\nLáº¥y key lÃºcğŸ”‘: {current_time}\nSupport 1ğŸ“¨: @llll0l0llll\nSupport 2ğŸ“¨: https://zalo.me/g/bprmyn080\nLink Key 1 ğŸ”‘: {link_key1}'

        admin_message = f"Key LÃ : {key}"
        bot.send_message(ADMIN_ID, admin_message)

        bot.send_video(message.chat.id, random_video_url, caption=message_text, parse_mode='html')


@bot.message_handler(commands=['start'])
def check_uptime(message):
    current_time = datetime.now()
    uptime = current_time - bot_start_time
    days = uptime.days
    hours, remainder = divmod(uptime.seconds, 3600)
    minutes, seconds = divmod(remainder, 60)
    
    uptime_str = f"{days} days, {hours}:{minutes:02}:{seconds:02}"
    bot.reply_to(message, f"ChÃ o má»«ng báº¡n Ä‘Ã£ Ä‘áº¿n vá»›i ğŸHDT-TOOLğŸ Nháº­p /get_key Ä‘á»ƒ láº¥y key.\nğŸ¤– Bot Ä‘Ã£ hoáº¡t Ä‘á»™ng trong {uptime_str}. ğŸ¤–")

bot.polling()

@bot.message_handler(func=lambda message: True)
def echo_all(message):
    bot.reply_to(message, 'ğŸš€Lá»‡nh khÃ´ng há»£p lá»‡. Vui lÃ²ng sá»­ dá»¥ng lá»‡nh /start Ä‘á»ƒ xem danh sÃ¡ch lá»‡nh.ğŸš€')

if __name__ == "__main__":
  bot.polling()